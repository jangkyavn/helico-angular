<nz-spin [nzSpinning]="spinning">
  <form nz-form [formGroup]="userForm" autocomplete="off">
    <nz-form-item>
      <nz-form-label [nzSm]="7" [nzXs]="24" nzRequired nzFor="userName">Tài khoản</nz-form-label>
      <nz-form-control [nzSm]="17" [nzXs]="24" nzErrorTip="Vui lòng nhập tài khoản!">
        <input type="text" nz-input formControlName="userName" id="userName" />
      </nz-form-control>
    </nz-form-item>
    <nz-form-item *ngIf="isAddNew">
      <nz-form-label [nzSm]="7" [nzXs]="24" nzRequired nzFor="password">Mật khẩu</nz-form-label>
      <nz-form-control [nzSm]="17" [nzXs]="24" [nzErrorTip]="errorPassword">
        <nz-input-group [nzSuffix]="suffixPasswordTemplate">
          <input [type]="passwordVisible ? 'text' : 'password'" nz-input formControlName="password" id="password" />
          <ng-template #errorPassword let-control>
            <ng-container *ngIf="control.hasError('required')">
              Vui lòng nhập mật khẩu!
            </ng-container>
            <ng-container *ngIf="control.hasError('minlength')">
              Vui lòng nhập mật khẩu ít nhất 6 ký tự!
            </ng-container>
          </ng-template>
        </nz-input-group>
        <ng-template #suffixPasswordTemplate>
          <i style="cursor: pointer;" nz-icon [nzType]="passwordVisible ? 'eye-invisible' : 'eye'"
            (click)="passwordVisible = !passwordVisible"></i>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item *ngIf="isAddNew">
      <nz-form-label [nzSm]="7" [nzXs]="24" nzRequired nzFor="confirmPassword">Nhập lại mật khẩu</nz-form-label>
      <nz-form-control [nzSm]="17" [nzXs]="24" [nzErrorTip]="errorConfirmPassword">
        <nz-input-group [nzSuffix]="suffixConfirmPasswordTemplate">
          <input [type]="confirmPasswordVisible ? 'text' : 'password'" nz-input formControlName="confirmPassword"
            id="confirmPassword" />
          <ng-template #errorConfirmPassword let-control>
            <ng-container *ngIf="control.hasError('required')">
              Vui lòng nhập lại mật khẩu!
            </ng-container>
            <ng-container *ngIf="control.hasError('notSame') && !control.hasError('required')">
              Mật khẩu và nhập lại mật khẩu chưa trùng khớp!
            </ng-container>
          </ng-template>
        </nz-input-group>
        <ng-template #suffixConfirmPasswordTemplate>
          <i style="cursor: pointer;" nz-icon [nzType]="confirmPasswordVisible ? 'eye-invisible' : 'eye'"
            (click)="confirmPasswordVisible = !confirmPasswordVisible"></i>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSm]="7" [nzXs]="24" nzRequired nzFor="fullName">Họ tên</nz-form-label>
      <nz-form-control [nzSm]="17" [nzXs]="24" nzErrorTip="Vui lòng nhập họ tên!">
        <input type="text" nz-input formControlName="fullName" id="fullName" />
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSm]="7" [nzXs]="24" nzRequired nzFor="email">Email</nz-form-label>
      <nz-form-control [nzSm]="17" [nzXs]="24" [nzErrorTip]="errorMail">
        <input type="text" nz-input formControlName="email" id="email" />
        <ng-template #errorMail let-control>
          <ng-container *ngIf="control.hasError('required')">
            Vui lòng nhập email!
          </ng-container>
          <ng-container *ngIf="control.hasError('email')">
            Vui lòng nhập email hợp lệ!
          </ng-container>
        </ng-template>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSm]="7" [nzXs]="24" nzRequired nzFor="gender">Giới tính</nz-form-label>
      <nz-form-control [nzSm]="17" [nzXs]="24" nzErrorTip="Vui lòng chọn giới tính!">
        <nz-radio-group formControlName="gender">
          <label *ngFor="let item of genders" nz-radio [nzValue]="item.value">{{item.name}}</label>
        </nz-radio-group>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSm]="7" [nzXs]="24" nzRequired nzFor="birthDay">Ngày sinh</nz-form-label>
      <nz-form-control [nzSm]="17" [nzXs]="24" nzErrorTip="Vui lòng nhập ngày sinh!">
        <input type="date" nz-input formControlName="birthDay" id="birthDay" />
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-label [nzSm]="7" [nzXs]="24" nzRequired nzFor="roleId">Vai trò</nz-form-label>
      <nz-form-control [nzSm]="17" [nzXs]="24" nzErrorTip="Vui lòng chọn vai trò!">
        <nz-select nzPlaceHolder="Chọn vai trò" nzAllowClear nzShowSearch formControlName="roleId" id="roleId">
          <ng-container *ngFor="let item of roles">
            <nz-option [nzValue]="item.id" [nzLabel]="item.name"></nz-option>
          </ng-container>
        </nz-select>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item style="margin-bottom: 0;">
      <nz-form-control [nzOffset]="7" [nzSm]="17" [nzXs]="24">
        <label nz-checkbox formControlName="status">Trạng thái</label>
      </nz-form-control>
    </nz-form-item>
  </form>
</nz-spin>

<div *nzModalFooter>
  <button nz-button nzType="default" (click)="destroyModal()">
    <i nz-icon nzType="close" nzTheme="outline"></i>Hủy
  </button>
  <button nz-button nzType="primary" (click)="saveChanges()" [nzLoading]="loadingSaveChanges">
    <i nz-icon nzType="save" nzTheme="outline"></i>Lưu
  </button>
</div>